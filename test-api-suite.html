<!DOCTYPE html>
<html>
<head>
    <title>AuraLearn API Test Suite</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f9f9f9;
        }
        button {
            background-color: #9929EA;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #CC66DA;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        pre {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid #ddd;
        }
        .error {
            color: #d32f2f;
            font-weight: bold;
        }
        .success {
            color: #388e3c;
            font-weight: bold;
        }
        .warning {
            color: #f57c00;
            font-weight: bold;
        }
        .section {
            margin: 30px 0;
            padding: 25px;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h2 {
            color: #9929EA;
            margin-bottom: 20px;
        }
        h3 {
            color: #666;
            margin-bottom: 15px;
        }
        input[type="text"] {
            width: 100%;
            padding: 10px;
            font-size: 14px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 15px;
        }
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }
        .status-indicator.success {
            background-color: #4caf50;
        }
        .status-indicator.error {
            background-color: #f44336;
        }
        .status-indicator.warning {
            background-color: #ff9800;
        }
    </style>
</head>
<body>
    <h1 style="text-align: center; color: #9929EA;">ðŸš€ AuraLearn API Test Suite</h1>
    
    <div class="section">
        <h2>ðŸ”§ Configuration</h2>
        <label for="apiUrl"><strong>Backend URL:</strong></label>
        <input type="text" id="apiUrl" value="https://limitless-caverns-03788-f84f5932a44c.herokuapp.com" placeholder="Enter backend URL">
    </div>
    
    <div class="section">
        <h2>ðŸ¤– AuraBot Tests</h2>
        <div class="test-grid">
            <button onclick="testHealth()">Health Check</button>
            <button onclick="testApi()">Test API Configuration</button>
            <button onclick="testAskQuestion()">Test Ask Question</button>
        </div>
        <h3>Response:</h3>
        <pre id="auraBotResponse">Click a button to test AuraBot endpoints...</pre>
    </div>
    
    <div class="section">
        <h2>âœ… AI Validation Tests</h2>
        <div class="test-grid">
            <button onclick="testValidation()">Test Validation API</button>
            <button onclick="testSubmitActivity()">Test Activity Submission</button>
        </div>
        <h3>Response:</h3>
        <pre id="validationResponse">Click a button to test AI Validation endpoints...</pre>
    </div>
    
    <script>
        const apiUrl = () => document.getElementById('apiUrl').value;
        
        function setLoading(elementId, message) {
            document.getElementById(elementId).innerHTML = `<span class="warning">${message}</span>`;
        }
        
        function formatResponse(data, status) {
            const statusClass = data.success ? 'success' : 'error';
            const statusIndicator = `<span class="status-indicator ${statusClass}"></span>`;
            return `${statusIndicator}<span class="${statusClass}">Status: ${status}</span>\n${JSON.stringify(data, null, 2)}`;
        }
        
        // AuraBot Tests
        async function testHealth() {
            setLoading('auraBotResponse', 'Testing health check...');
            try {
                const response = await fetch(`${apiUrl()}/api/aurabot/health`);
                const data = await response.json();
                document.getElementById('auraBotResponse').innerHTML = formatResponse(data, response.status);
            } catch (error) {
                document.getElementById('auraBotResponse').innerHTML = `<div class="error">Error: ${error.message}</div>`;
            }
        }
        
        async function testApi() {
            setLoading('auraBotResponse', 'Testing API configuration...');
            try {
                const response = await fetch(`${apiUrl()}/api/aurabot/test-api`);
                const data = await response.json();
                document.getElementById('auraBotResponse').innerHTML = formatResponse(data, response.status);
            } catch (error) {
                document.getElementById('auraBotResponse').innerHTML = `<div class="error">Error: ${error.message}</div>`;
            }
        }
        
        async function testAskQuestion() {
            setLoading('auraBotResponse', 'Sending question to AuraBot...');
            try {
                const sessionId = `test-session-${Date.now()}`;
                const response = await fetch(`${apiUrl()}/api/aurabot/ask`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({
                        session_id: sessionId,
                        question: 'What is HTML and why is it important?',
                        user_id: null
                    })
                });
                const data = await response.json();
                document.getElementById('auraBotResponse').innerHTML = formatResponse(data, response.status);
            } catch (error) {
                document.getElementById('auraBotResponse').innerHTML = `<div class="error">Error: ${error.message}</div>`;
            }
        }
        
        // AI Validation Tests
        async function testValidation() {
            setLoading('validationResponse', 'Testing AI validation API...');
            try {
                const response = await fetch(`${apiUrl()}/api/activities/test-validation`);
                const data = await response.json();
                document.getElementById('validationResponse').innerHTML = formatResponse(data, response.status);
            } catch (error) {
                document.getElementById('validationResponse').innerHTML = `<div class="error">Error: ${error.message}</div>`;
            }
        }
        
        async function testSubmitActivity() {
            setLoading('validationResponse', 'Testing activity submission with AI validation...');
            try {
                const testCode = `<!DOCTYPE html>
<html>
<head>
    <title>My First Page</title>
</head>
<body>
    <h1>Welcome!</h1>
    <p>This is my first HTML page.</p>
</body>
</html>`;
                
                const response = await fetch(`${apiUrl()}/api/activities/1/submit`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({
                        user_code: testCode,
                        time_spent_minutes: 5,
                        user_id: 1
                    })
                });
                const data = await response.json();
                document.getElementById('validationResponse').innerHTML = formatResponse(data, response.status);
            } catch (error) {
                document.getElementById('validationResponse').innerHTML = `<div class="error">Error: ${error.message}</div>`;
            }
        }
    </script>
</body>
</html>
